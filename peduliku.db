==================
/* Bikin database peduliku */
CREATE DATABASE peduliku;

/* Tabel Negara */

CREATE TABLE m_negara (
 id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
 kode varchar(25) NOT NULL,
 nama varchar(50) NOT NULL,
 created_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 updated_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 deleted_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 created_by varchar(25) NOT NULL,
 updated_by varchar(25) NOT NULL,
 deleted_by varchar(25) NOT NULL
);


/* Tabel Provinsi */

CREATE TABLE m_provinsi (
 id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
 kode varchar(25) NOT NULL, 
 nama varchar(50) NOT NULL,
 created_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 updated_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 deleted_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 created_by varchar(25) NOT NULL,
 updated_by varchar(25) NOT NULL,
 deleted_by varchar(25) NOT NULL
);

/* Tabel Kabupaten Kota */

CREATE TABLE m_kota (
 id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
kode varchar(25) NOT NULL,
nama varchar(50) NOT NULL,
 created_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 updated_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 deleted_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 created_by varchar(25) NOT NULL,
 updated_by varchar(25) NOT NULL,
 deleted_by varchar(25) NOT NULL
);

/* Tabel Kecamatan */

CREATE TABLE m_kecamatan (
 id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
kode varchar(25) NOT NULL,
nama varchar(50) NOT NULL,
 created_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 updated_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 deleted_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 created_by varchar(25) NOT NULL,
 updated_by varchar(25) NOT NULL,
 deleted_by varchar(25) NOT NULL
);

/* Tabel Kelurahan */

CREATE TABLE m_kelurahan (
 id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
kode varchar(25) NOT NULL,
nama varchar(50) NOT NULL,
 created_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 updated_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 deleted_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 created_by varchar(25) NOT NULL,
 updated_by varchar(25) NOT NULL,
 deleted_by varchar(25) NOT NULL
);

/* Tabel Alamat */

CREATE TABLE m_alamat (
 id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
rt varchar(5),
rw varchar(5),
detil varchar(50),
kodepos varchar(20),
m_kelurahan_id int,
 created_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 updated_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 deleted_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
 created_by varchar(25) NOT NULL,
 updated_by varchar(25) NOT NULL,
 deleted_by varchar(25) NOT NULL,
FOREIGN KEY (m_kelurahan_id) REFERENCES m_kelurahan(id)
                        ON DELETE CASCADE
);

/* Tabel people */

CREATE TABLE m_people (
  id bigint NOT NULL AUTO_INCREMENT PRIMARY KEY,
  nik varchar(20) NOT NULL,
  nama varchar(50) NOT NULL,
  tempatlahir varchar(50) NOT NULL,
  tanggallahir date NOT NULL,
  foto varchar(50) NOT NULL,
  m_alamat_id int NOT NULL,
  created_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  updated_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  deleted_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  created_by varchar(25) NOT NULL,
  updated_by varchar(25) NOT NULL,
  deleted_by varchar(25) NOT NULL,
  FOREIGN KEY (m_alamat_id) REFERENCES m_alamat (id) ON DELETE CASCADE
);


/* Tabel Kartu keluarga */

CREATE TABLE m_kartukeluarga (
  id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
  nomor varchar(25) NOT NULL,
  tglterbit date NOT NULL,
  created_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  updated_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  deleted_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  created_by varchar(25) NOT NULL,
  updated_by varchar(25) NOT NULL,
  deleted_by varchar(25) NOT NULL
);


/* Tabel Anggota Kartu keluarga */

CREATE TABLE t_kartukeluarga_anggota (
  id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
  m_kartukeluarga_id int NOT NULL,
  m_people_id bigint NOT NULL,
  created_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  updated_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  deleted_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  created_by varchar(25) NOT NULL,
  updated_by varchar(25) NOT NULL,
  deleted_by varchar(25) NOT NULL,
  FOREIGN KEY (m_kartukeluarga_id) REFERENCES m_kartukeluarga (id) ON DELETE CASCADE,
  FOREIGN KEY (m_people_id) REFERENCES m_people (id) ON DELETE CASCADE
);

/* Tabel Kategori Surat */

CREATE TABLE m_kategori_surat (
  id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
  nama varchar(25) NOT NULL,
  created_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  updated_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  deleted_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  created_by varchar(25) NOT NULL,
  updated_by varchar(25) NOT NULL,
  deleted_by varchar(25) NOT NULL
);

/* Tabel Surat */

CREATE TABLE t_surat (
  id bigint NOT NULL AUTO_INCREMENT PRIMARY KEY,
  nomor varchar(25) NOT NULL,
  tanggal date NOT NULL,
  m_kategori_surat_id int NOT NULL,
  tentang varchar(50) NOT NULL,
  file varchar(50) NOT NULL,
  created_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  updated_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  deleted_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  created_by varchar(25) NOT NULL,
  updated_by varchar(25) NOT NULL,
  deleted_by varchar(25) NOT NULL,
  FOREIGN KEY (m_kategori_surat_id) REFERENCES m_kategori_surat (id) ON DELETE CASCADE
);

/* Tabel Pegawai */

CREATE TABLE t_pegawai (
  id int NOT NULL AUTO_INCREMENT PRIMARY KEY,
  m_people_id bigint NOT NULL,
  t_surat_id bigint NOT NULL,
  created_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  updated_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  deleted_at datetime NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  created_by varchar(25) NOT NULL,
  updated_by varchar(25) NOT NULL,
  deleted_by varchar(25) NOT NULL,
  FOREIGN KEY (m_people_id) REFERENCES m_people (id) ON DELETE CASCADE,
  FOREIGN KEY (t_surat_id) REFERENCES t_surat (id) ON DELETE CASCADE
);
